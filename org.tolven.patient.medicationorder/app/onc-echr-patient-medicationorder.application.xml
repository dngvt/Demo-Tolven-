<application xmlns="urn:tolven-org:menuStructure:1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:tolven-org:menuStructure:1.0 http://tolven.org/xsd/menuStructure.xsd">
    
	<extends path="echr:patient">
		<placeholder name="medicationorder" title="Medication Order" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/medicationOrderLink.xhtml">
			<field name="title" internal="string01">
				<from>#{act.participation['consumable'].role.player.code.CE.displayName}</from>
				<from>#{act.participation['consumableProduct'].role.player.code.CE.displayName}</from><!-- eprescription -->
    		</field>
			<field name="code" internal="string02">
				<from>#{act.participation['consumable'].role.player.code.CE.code}</from>
			</field>
			<field name="codeCE">
				<from>#{act.participation['consumable'].role.player.code.CE}</from>
			</field>
			<field name="start" internal="ts01">
				<from>#{act.effectiveTime.TS.date}</from>
				<from>#{act.participation['consumableProduct'].role.effectiveTime.IVLTS.low.TS.date}</from>	 <!-- eprescription -->			
				<from>#{act.effectiveTime.IVLTS.low.date}</from>
    		</field>
			<field name="end" internal="ts0202">
				<from>#{act.effectiveTime.IVLTS.high.date}</from>
				<from>#{act.relationship['consumableProduct'].act.effectiveTime.IVLTS.high.TS.date}</from>	 <!-- eprescription -->
			</field>
			<field name="status" internal="actStatus">
				<from>#{toLowerCaseValue(act.statusCode)}</from>
				<from>#{toLowerCaseValue(trim.act.statusCode)}</from>
			</field>
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
			<field name="author" internal="parent02">
				<from>#{internalId( account, trim.act.participation['author'].role.id)}</from>
			</field>
			<field name="enteredBy" internal="string03">
				<from>#{internalId( account, trim.act.participation['dataEnterer'].role.id)}</from>
          </field>
			<field name="encounter" internal="parent03">
				<from>#{internalId( account, trim.act.relationship['encounter'].act.id)}</from>				
			</field>
			<field name="route" internal="string04">
				<from>#{act.substanceAdministration.routeCode.value.displayName}</from>
			</field>
			<field name="routeCE" internal="_extended">
				<from>#{act.substanceAdministration.routeCode.value}</from>
			</field>
			<field name="frequency" internal="string05">
				<from>#{act.relationship['frequency'].act.observation.value.CE.displayName}</from>
    		</field>
			<field name="frequencyCE" internal="_extended">
				<from>#{act.relationship['frequency'].act.observation.value.CE}</from>
			</field>
			<field name="comments" internal="_extended">
				<from>#{act.relationship['comments'].act.text.originalText}</from>
				<from>#{act.relationship['comment'].act.observation.value.ED}</from>	
			</field>
			<field name="numberOfUnits" internal="string06">
				<from>#{act.participation['consumable'].role.player.quantity.PQ.originalText}</from>
				<from>#{act.participation['consumableProduct'].role.player.quantity.PQ.originalText}</from><!-- eprescription -->
			</field>
			<field name="numberOfTimes" internal="string07">
				<from>#{act.relationship['numberOfTimes'].act.observation.value.ST.value}</from>
			</field>
			<field name="startImmediatly" internal="_extended">
			    <from>#{act.relationship['startImmediatly'].act.observation.value.CE.displayName}</from>
			</field>			
			<field name="startImmediatlyCE">
			    <from>#{act.relationship['startImmediatly'].act.observation.value.CE}</from>
			</field>	
			<field name="gts" internal="gts01"/>
				
		</placeholder>
	</extends>
	<extends path="echr:patient:summary">
		<list name="medordersum" visible="never">
			<column name="date" internal="date01" format="MM/dd/yyyy">
				<from>#{medicationorder.start}</from>
			</column>
			<column name="title" internal="string01">
				<from>#{medicationorder.title}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary:portal">
		<portlet name="medordersum" portalColumn="2" sequence="1" title="Medication Orders" page="/five/summaryPortletList.xhtml" query="echr:patient:summary:medordersum" visible="true">
			<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:medicationOrderMenu">
				<column name="Medication" internal="string01" instantiate="true" width="40.0">
				</column>
			</action>
		</portlet>
	</extends>
	<extends path="echr:patient">
		<menu name="medicationorders" sequence="4" title="Medication Orders" page="/five/bar2.xhtml" visible="true">
			<list name="active" title="Active" page="/five/list.xhtml" visible="true" drilldown=":medicationorder">
				<column name="Start" internal="ts01" format="MMM-dd-yyyy" width="10.0">
					<from>#{medicationorder.start}</from>
				</column>
				<column name="Name" internal="string01" reference="true" width="15.0">
					<from>#{medicationorder.title}</from>
				</column>
				<column name="Route" internal="string03" width="10.0">
					<from>#{medicationorder.route}</from>
				</column>
				<column name="Frequency" internal="string04" width="10.0">
					<from>#{medicationorder.frequency}</from>
				</column>
				<column name="EnteredBy" internal="string05" width="10.0">
					<from>#{medicationorder.enteredBy}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:medicationOrderMenu">
					<column name="Medication" internal="string01" instantiate="true" width="40.0" />
				</action>
			</list>
			
			<list name="all" title="All" page="/five/list.xhtml" visible="true" drilldown=":medicationorder">
				<column name="Start" internal="ts01" format="MMM-dd-yyyy" width="10.0">
					<from>#{medicationorder.start}</from>
				</column>
				<column name="Name" internal="string01" reference="true" width="15.0">
					<from>#{medicationorder.title}</from>
				</column>
				<column name="Route" internal="string03" width="10.0">
					<from>#{medicationorder.route}</from>
				</column>
				<column name="Frequency" internal="string04" width="10.0">
					<from>#{medicationorder.frequency}</from>
				</column>
				<column name="EnteredBy" internal="string05" width="10.0">
					<from>#{medicationorder.enteredBy}</from>
				</column>			
			</list>
			<list name="nullified" title="Entered in Error" page="/five/list.xhtml" visible="true" drilldown=":medicationorder">
				<column name="Start" internal="ts01" format="MMM-dd-yyyy" width="10.0">
					<from>#{medicationorder.start}</from>
				</column>
				<column name="Name" internal="string01" reference="true" width="15.0">
					<from>#{medicationorder.title}</from>
				</column>
				<column name="Route" internal="string03" width="10.0">
					<from>#{medicationorder.route}</from>
				</column>
				<column name="Frequency" internal="string04" width="10.0">
					<from>#{medicationorder.frequency}</from>
				</column>
				<column name="EnteredBy" internal="string05" width="10.0">
					<from>#{medicationorder.enteredBy}</from>
				</column>
			</list>			
		</menu>
	</extends>
	<extends path="echr:patient:summary:calendar">
		<entry name="medorders" sequence="2" title="Active Medication" query="echr:patient:summary:medordersum" visible="true" drilldown=":medicationorders" />
	</extends>
	
	
	
	<extends path="echr:patient">
		<menu name="orders" sequence="2" title="Orders" page="/five/bar2.xhtml" visible="true">
			<list name="active" title="Active" page="/five/list.xhtml" visible="true" drilldown=":active">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="15.0">
					<from>#{medicationorder.start}</from>
				</column>
				<column name="Name" internal="string01" width="30.0" reference="true">
					<from>#{medicationorder.title}</from>
				</column>
				<column name="Status" internal="string02" width="30.0">
					<from>#{medicationorder.status}</from>					
				</column>
				<column width="15.0" internal="string03" name="Performer">
					<from>#{medicationorder.enteredBy}</from>		
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:newOrderMenu">
					<column name="Title" internal="string01" instantiate="true" width="40.0" />
				</action>
			</list>
			<!-- <list name="completed" title="Completed" page="/five/list.xhtml" visible="true" drilldown=":completed">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="15.0">
					<from>#{labOrder.date}</from>
					<from>#{imageOrder.date}</from>
				</column>
				<column name="Name" internal="string01" width="30.0" reference="true">
					<from>#{labOrder.serviceName}</from>
					<from>#{imageOrder.serviceName}</from>
				</column>
				<column name="Status" internal="string02" width="30.0">
					<from>#{labOrder.status}</from>
					<from>#{imageOrder.status}</from>
				</column>
				<column width="15.0" internal="string03" name="Performer">
					<from>#{labOrder.author.lastName}</from>
					<from>#{labOrder.enteredBy}</from>
					<from>#{imageOrder.author.lastName}</from>
					<from>#{imageOrder.enteredBy}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:newOrderMenu">
					<column name="Title" internal="string01" instantiate="true" width="40.0" />
				</action>
			</list>
			<list name="inactive" title="Inactive" page="/five/list.xhtml" visible="true" drilldown=":inactive">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="15.0">
					<from>#{labOrder.date}</from>
					<from>#{imageOrder.date}</from>
				</column>
				<column name="Name" internal="string01" width="30.0" reference="true">
					<from>#{labOrder.serviceName}</from>
					<from>#{imageOrder.serviceName}</from>
				</column>
				<column name="Status" internal="string02" width="30.0">
					<from>#{labOrder.status}</from>
					<from>#{imageOrder.status}</from>
				</column>
				<column width="15.0" internal="string03" name="Performer">
					<from>#{labOrder.author.lastName}</from>
					<from>#{labOrder.enteredBy}</from>
					<from>#{imageOrder.author.lastName}</from>
					<from>#{imageOrder.enteredBy}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:newOrderMenu">
					<column name="Title" internal="string01" instantiate="true" width="40.0" />
				</action>
			</list>
			<list name="cancelled" title="Cancelled" page="/five/list.xhtml" visible="true" drilldown=":cancelled">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="15.0">
					<from>#{labOrder.date}</from>
					<from>#{imageOrder.date}</from>
				</column>
				<column name="Name" internal="string01" width="30.0" reference="true">
					<from>#{labOrder.serviceName}</from>
					<from>#{imageOrder.serviceName}</from>
				</column>
				<column name="Status" internal="string02" width="30.0">
					<from>#{labOrder.status}</from>
					<from>#{imageOrder.status}</from>
				</column>
				<column width="15.0" internal="string03" name="Performer">
					<from>#{labOrder.author.lastName}</from>
					<from>#{labOrder.enteredBy}</from>
					<from>#{imageOrder.author.lastName}</from>
					<from>#{imageOrder.enteredBy}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:newOrderMenu">
					<column name="Title" internal="string01" instantiate="true" width="40.0" />
				</action>
			</list>
			<list name="suspended" title="Suspended" page="/five/list.xhtml" visible="true" drilldown=":suspended">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="15.0">
					<from>#{labOrder.date}</from>
					<from>#{imageOrder.date}</from>
				</column>
				<column name="Name" internal="string01" width="30.0" reference="true">
					<from>#{labOrder.serviceName}</from>
					<from>#{imageOrder.serviceName}</from>
				</column>
				<column name="Status" internal="string02" width="30.0">
					<from>#{labOrder.status}</from>
					<from>#{imageOrder.status}</from>
				</column>
				<column width="15.0" internal="string03" name="Performer">
					<from>#{labOrder.author.lastName}</from>
					<from>#{labOrder.enteredBy}</from>
					<from>#{imageOrder.author.lastName}</from>
					<from>#{imageOrder.enteredBy}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:newOrderMenu">
					<column name="Title" internal="string01" instantiate="true" width="40.0" />
				</action>
			</list>
			<list name="nullified" title="Entered in Error" page="/five/list.xhtml" visible="true" drilldown=":nullified">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="15.0">
					<from>#{labOrder.date}</from>
					<from>#{imageOrder.date}</from>
				</column>
				<column name="Name" internal="string01" width="30.0" reference="true">
					<from>#{labOrder.serviceName}</from>
					<from>#{imageOrder.serviceName}</from>
				</column>
				<column name="Status" internal="string02" width="30.0">
					<from>#{labOrder.status}</from>
					<from>#{imageOrder.status}</from>
				</column>
				<column width="15.0" internal="string03" name="Performer">
					<from>#{labOrder.author.lastName}</from>
					<from>#{labOrder.enteredBy}</from>
					<from>#{imageOrder.author.lastName}</from>
					<from>#{imageOrder.enteredBy}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:newOrderMenu">
					<column name="Title" internal="string01" instantiate="true" width="40.0" />
				</action>
			</list>
			<list name="all" title="All" page="/five/list.xhtml" visible="true" drilldown=":all">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="15.0">
					<from>#{labOrder.date}</from>
					<from>#{imageOrder.date}</from>
				</column>
				<column name="Name" internal="string01" width="30.0" reference="true">
					<from>#{labOrder.serviceName}</from>
					<from>#{imageOrder.serviceName}</from>
				</column>
				<column name="Status" internal="string02" width="30.0">
					<from>#{labOrder.status}</from>
					<from>#{imageOrder.status}</from>
				</column>
				<column width="15.0" internal="string03" name="Performer">
					<from>#{labOrder.author.lastName}</from>
					<from>#{labOrder.enteredBy}</from>
					<from>#{imageOrder.author.lastName}</from>
					<from>#{imageOrder.enteredBy}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:newOrderMenu">
					<column name="Title" internal="string01" instantiate="true" width="40.0" />
				</action>
			</list>
			<list name="immunizationList" title="Immunization list" page="/five/list.xhtml" visible="true" drilldown=":immunizationOrder">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="15.0">
					<from>#{immunizationOrder.date}</from>
				</column>
				<column name="Name" internal="string01" width="30.0" reference="true">
					<from>#{immunizationOrder.serviceName}</from>
				</column>
				<column name="Status" internal="string02" width="30.0">
					<from>#{immunizationOrder.status}</from>
				</column>
				<column width="15.0" internal="string03" name="Performer">
					<from>#{immunizationOrder.author.lastName}</from>
					<from>#{immunizationOrder.enteredBy}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:immunizationOrderDocMenu">
					<column name="Title" internal="string01" instantiate="true" width="40.0" />
				</action>
			</list>
 -->
		</menu>
	</extends>
	<!-- <extends path="echr:patient:summary">
		<list name="orderSummary" visible="never">
			<column name="Date" internal="date01" format="MM/dd/yyyy">
				<from>#{imageOrder.date}</from>
				<from>#{labOrder.date}</from>
			</column>
			<column name="Name" internal="string01">
				<from>#{imageOrder.serviceName}</from>
				<from>#{labOrder.serviceName}</from>
			</column>
			<column name="Status" internal="string02">
				<from>#{imageOrder.status}</from>
				<from>#{labOrder.status}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary:portal">
		<portlet name="orderSummary" portalColumn="1" sequence="5" title="Orders" page="/five/summaryPortletList.xhtml" query="echr:patient:summary:orderSummary" visible="true" drilldown=":orders:active">
			<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:newOrderMenu">
				<column name="Title" internal="string01" instantiate="true" width="40.0" />
			</action>
		</portlet>
	</extends> -->
	
</application>